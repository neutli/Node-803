#include "OpenSimplex2.hpp"
#include <cmath>
#include <vector>
#include <mutex>
#include <cstdint>

namespace {
    // Common Constants
    const int64_t PRIME_X = 0x5205402B9270C86F;
    const int64_t PRIME_Y = 0x598CD327003817B5;
    const int64_t PRIME_Z = 0x5BCC226E9FA0BACB;
    const int64_t PRIME_W = 0x56CC5227E58F554B;
    const int64_t HASH_MULTIPLIER = 0x53A3F72DEEC546F5;
}

// ============================================================================
// OpenSimplex2S Implementation (Smooth)
// ============================================================================

namespace {
    namespace Smooth {
        const int64_t SEED_FLIP_3D = -0x52D547B2E96ED629LL;
        
        const double ROOT2OVER2 = 0.7071067811865476;
        const double SKEW_2D = 0.366025403784439;
        const double UNSKEW_2D = -0.21132486540518713;
        
        const double ROOT3OVER3 = 0.577350269189626;
        const double FALLBACK_ROTATE3 = 2.0 / 3.0;
        const double ROTATE3_ORTHOGONALIZER = UNSKEW_2D;
        
        const float SKEW_4D = 0.309016994374947f;
        const float UNSKEW_4D = -0.138196601125011f;
        
        const int N_GRADS_2D_EXPONENT = 7;
        const int N_GRADS_3D_EXPONENT = 8;
        const int N_GRADS_4D_EXPONENT = 9;
        const int N_GRADS_2D = 1 << N_GRADS_2D_EXPONENT;
        const int N_GRADS_3D = 1 << N_GRADS_3D_EXPONENT;
        const int N_GRADS_4D = 1 << N_GRADS_4D_EXPONENT;
        
        const double NORMALIZER_2D = 0.05481866495625118;
        const double NORMALIZER_3D = 0.2781926117527186;
        const double NORMALIZER_4D = 0.11127401889945551;
        
        const float RSQUARED_2D = 2.0f / 3.0f;
        const float RSQUARED_3D = 3.0f / 4.0f;
        const float RSQUARED_4D = 4.0f / 5.0f;

        const double GRAD2_SRC[] = {
            0.38268343236509,   0.923879532511287,
            0.923879532511287,  0.38268343236509,
            0.923879532511287, -0.38268343236509,
            0.38268343236509,  -0.923879532511287,
            -0.38268343236509,  -0.923879532511287,
            -0.923879532511287, -0.38268343236509,
            -0.923879532511287,  0.38268343236509,
            -0.38268343236509,   0.923879532511287,
            0.130526192220052,  0.99144486137381,
            0.608761429008721,  0.793353340291235,
            0.793353340291235,  0.608761429008721,
            0.99144486137381,   0.130526192220051,
            0.99144486137381,  -0.130526192220051,
            0.793353340291235, -0.60876142900872,
            0.608761429008721, -0.793353340291235,
            0.130526192220052, -0.99144486137381,
            -0.130526192220052, -0.99144486137381,
            -0.608761429008721, -0.793353340291235,
            -0.793353340291235, -0.608761429008721,
            -0.99144486137381,  -0.130526192220052,
            -0.99144486137381,   0.130526192220051,
            -0.793353340291235,  0.608761429008721,
            -0.608761429008721,  0.793353340291235,
            -0.130526192220052,  0.99144486137381,
        };

        const double GRAD3_SRC[] = {
            2.22474487139,       2.22474487139,      -1.0,                 0.0,
            2.22474487139,       2.22474487139,       1.0,                 0.0,
            3.0862664687972017,  1.1721513422464978,  0.0,                 0.0,
            1.1721513422464978,  3.0862664687972017,  0.0,                 0.0,
            -2.22474487139,       2.22474487139,      -1.0,                 0.0,
            -2.22474487139,       2.22474487139,       1.0,                 0.0,
            -1.1721513422464978,  3.0862664687972017,  0.0,                 0.0,
            -3.0862664687972017,  1.1721513422464978,  0.0,                 0.0,
            -1.0,                -2.22474487139,      -2.22474487139,       0.0,
            1.0,                -2.22474487139,      -2.22474487139,       0.0,
            0.0,                -3.0862664687972017, -1.1721513422464978,  0.0,
            0.0,                -1.1721513422464978, -3.0862664687972017,  0.0,
            -1.0,                -2.22474487139,       2.22474487139,       0.0,
            1.0,                -2.22474487139,       2.22474487139,       0.0,
            0.0,                -1.1721513422464978,  3.0862664687972017,  0.0,
            0.0,                -3.0862664687972017,  1.1721513422464978,  0.0,
            -2.22474487139,      -2.22474487139,      -1.0,                 0.0,
            -2.22474487139,      -2.22474487139,       1.0,                 0.0,
            -3.0862664687972017, -1.1721513422464978,  0.0,                 0.0,
            -1.1721513422464978, -3.0862664687972017,  0.0,                 0.0,
            -2.22474487139,      -1.0,                -2.22474487139,       0.0,
            -2.22474487139,       1.0,                -2.22474487139,       0.0,
            -1.1721513422464978,  0.0,                -3.0862664687972017,  0.0,
            -3.0862664687972017,  0.0,                -1.1721513422464978,  0.0,
            -2.22474487139,      -1.0,                 2.22474487139,       0.0,
            -2.22474487139,       1.0,                 2.22474487139,       0.0,
            -3.0862664687972017,  0.0,                 1.1721513422464978,  0.0,
            -1.1721513422464978,  0.0,                 3.0862664687972017,  0.0,
            -1.0,                 2.22474487139,      -2.22474487139,       0.0,
            1.0,                 2.22474487139,      -2.22474487139,       0.0,
            0.0,                 1.1721513422464978, -3.0862664687972017,  0.0,
            0.0,                 3.0862664687972017, -1.1721513422464978,  0.0,
            -1.0,                 2.22474487139,       2.22474487139,       0.0,
            1.0,                 2.22474487139,       2.22474487139,       0.0,
            0.0,                 3.0862664687972017,  1.1721513422464978,  0.0,
            0.0,                 1.1721513422464978,  3.0862664687972017,  0.0,
            2.22474487139,      -2.22474487139,      -1.0,                 0.0,
            2.22474487139,      -2.22474487139,       1.0,                 0.0,
            1.1721513422464978, -3.0862664687972017,  0.0,                 0.0,
            3.0862664687972017, -1.1721513422464978,  0.0,                 0.0,
            2.22474487139,      -1.0,                -2.22474487139,       0.0,
            2.22474487139,       1.0,                -2.22474487139,       0.0,
            3.0862664687972017,  0.0,                -1.1721513422464978,  0.0,
            1.1721513422464978,  0.0,                -3.0862664687972017,  0.0,
            2.22474487139,      -1.0,                 2.22474487139,       0.0,
            2.22474487139,       1.0,                 2.22474487139,       0.0,
            1.1721513422464978,  0.0,                 3.0862664687972017,  0.0,
            3.0862664687972017,  0.0,                 1.1721513422464978,  0.0,
        };

        const double GRAD4_SRC[] = {
            -0.6740059517812944,   -0.3239847771997537,   -0.3239847771997537,    0.5794684678643381,
            -0.7504883828755602,   -0.4004672082940195,    0.15296486218853164,   0.5029860367700724,
            -0.7504883828755602,    0.15296486218853164,  -0.4004672082940195,    0.5029860367700724,
            -0.8828161875373585,    0.08164729285680945,   0.08164729285680945,   0.4553054119602712,
            -0.4553054119602712,   -0.08164729285680945,  -0.08164729285680945,   0.8828161875373585,
            -0.5029860367700724,   -0.15296486218853164,   0.4004672082940195,    0.7504883828755602,
            -0.5029860367700724,    0.4004672082940195,   -0.15296486218853164,   0.7504883828755602,
            -0.5794684678643381,    0.3239847771997537,    0.3239847771997537,    0.6740059517812944,
            -0.6740059517812944,   -0.3239847771997537,    0.5794684678643381,   -0.3239847771997537,
            -0.7504883828755602,   -0.4004672082940195,    0.5029860367700724,    0.15296486218853164,
            -0.7504883828755602,    0.15296486218853164,   0.5029860367700724,   -0.4004672082940195,
            -0.8828161875373585,    0.08164729285680945,   0.4553054119602712,    0.08164729285680945,
            -0.4553054119602712,   -0.08164729285680945,   0.8828161875373585,   -0.08164729285680945,
            -0.5029860367700724,   -0.15296486218853164,   0.7504883828755602,    0.4004672082940195,
            -0.5029860367700724,    0.4004672082940195,    0.7504883828755602,   -0.15296486218853164,
            -0.5794684678643381,    0.3239847771997537,    0.6740059517812944,    0.3239847771997537,
            -0.6740059517812944,    0.5794684678643381,   -0.3239847771997537,   -0.3239847771997537,
            -0.7504883828755602,    0.5029860367700724,   -0.4004672082940195,    0.15296486218853164,
            -0.7504883828755602,    0.5029860367700724,    0.15296486218853164,  -0.4004672082940195,
            -0.8828161875373585,    0.4553054119602712,    0.08164729285680945,   0.08164729285680945,
            -0.4553054119602712,    0.8828161875373585,   -0.08164729285680945,  -0.08164729285680945,
            -0.5029860367700724,    0.7504883828755602,   -0.15296486218853164,   0.4004672082940195,
            -0.5029860367700724,    0.7504883828755602,    0.4004672082940195,   -0.15296486218853164,
            -0.5794684678643381,    0.6740059517812944,    0.3239847771997537,    0.3239847771997537,
             0.5794684678643381,   -0.6740059517812944,   -0.3239847771997537,   -0.3239847771997537,
             0.5029860367700724,   -0.7504883828755602,   -0.4004672082940195,    0.15296486218853164,
             0.5029860367700724,   -0.7504883828755602,    0.15296486218853164,  -0.4004672082940195,
             0.4553054119602712,   -0.8828161875373585,    0.08164729285680945,   0.08164729285680945,
             0.8828161875373585,   -0.4553054119602712,   -0.08164729285680945,  -0.08164729285680945,
             0.7504883828755602,   -0.5029860367700724,   -0.15296486218853164,   0.4004672082940195,
             0.7504883828755602,   -0.5029860367700724,    0.4004672082940195,   -0.15296486218853164,
             0.6740059517812944,   -0.5794684678643381,    0.3239847771997537,    0.3239847771997537,
            -0.753341017856078,    -0.37968289875261624,  -0.37968289875261624,  -0.37968289875261624,
            -0.7821684431180708,   -0.4321472685365301,   -0.4321472685365301,    0.12128480194602098,
            -0.7821684431180708,   -0.4321472685365301,    0.12128480194602098,  -0.4321472685365301,
            -0.7821684431180708,    0.12128480194602098,  -0.4321472685365301,   -0.4321472685365301,
            -0.8586508742123365,   -0.508629699630796,     0.044802370851755174,  0.044802370851755174,
            -0.8586508742123365,    0.044802370851755174, -0.508629699630796,     0.044802370851755174,
            -0.8586508742123365,    0.044802370851755174,  0.044802370851755174, -0.508629699630796,
            -0.9982828964265062,   -0.03381941603233842,  -0.03381941603233842,  -0.03381941603233842,
            -0.37968289875261624,  -0.753341017856078,    -0.37968289875261624,  -0.37968289875261624,
            -0.4321472685365301,   -0.7821684431180708,   -0.4321472685365301,    0.12128480194602098,
            -0.4321472685365301,   -0.7821684431180708,    0.12128480194602098,  -0.4321472685365301,
             0.12128480194602098,  -0.7821684431180708,   -0.4321472685365301,   -0.4321472685365301,
            -0.508629699630796,    -0.8586508742123365,    0.044802370851755174,  0.044802370851755174,
             0.044802370851755174, -0.8586508742123365,   -0.508629699630796,     0.044802370851755174,
             0.044802370851755174, -0.8586508742123365,    0.044802370851755174, -0.508629699630796,
            -0.03381941603233842,  -0.9982828964265062,   -0.03381941603233842,  -0.03381941603233842,
            -0.37968289875261624,  -0.37968289875261624,  -0.753341017856078,    -0.37968289875261624,
            -0.4321472685365301,   -0.4321472685365301,   -0.7821684431180708,    0.12128480194602098,
            -0.4321472685365301,    0.12128480194602098,  -0.7821684431180708,   -0.4321472685365301,
             0.12128480194602098,  -0.4321472685365301,   -0.7821684431180708,   -0.4321472685365301,
            -0.508629699630796,     0.044802370851755174, -0.8586508742123365,    0.044802370851755174,
             0.044802370851755174, -0.508629699630796,    -0.8586508742123365,    0.044802370851755174,
             0.044802370851755174,  0.044802370851755174, -0.8586508742123365,   -0.508629699630796,
            -0.03381941603233842,  -0.03381941603233842,  -0.9982828964265062,   -0.03381941603233842,
            -0.3239847771997537,   -0.6740059517812944,   -0.3239847771997537,    0.5794684678643381,
            -0.4004672082940195,   -0.7504883828755602,    0.15296486218853164,   0.5029860367700724,
             0.15296486218853164,  -0.7504883828755602,   -0.4004672082940195,    0.5029860367700724,
             0.08164729285680945,  -0.8828161875373585,    0.08164729285680945,   0.4553054119602712,
            -0.08164729285680945,  -0.4553054119602712,   -0.08164729285680945,   0.8828161875373585,
            -0.15296486218853164,  -0.5029860367700724,    0.4004672082940195,    0.7504883828755602,
             0.4004672082940195,   -0.5029860367700724,   -0.15296486218853164,   0.7504883828755602,
             0.3239847771997537,   -0.5794684678643381,    0.3239847771997537,    0.6740059517812944,
            -0.3239847771997537,   -0.3239847771997537,   -0.6740059517812944,    0.5794684678643381,
            -0.4004672082940195,    0.15296486218853164,  -0.7504883828755602,    0.5029860367700724,
             0.15296486218853164,  -0.4004672082940195,   -0.7504883828755602,    0.5029860367700724,
             0.08164729285680945,   0.08164729285680945,  -0.8828161875373585,    0.4553054119602712,
            -0.08164729285680945,  -0.08164729285680945,  -0.4553054119602712,    0.8828161875373585,
            -0.15296486218853164,   0.4004672082940195,   -0.5029860367700724,    0.7504883828755602,
             0.4004672082940195,   -0.15296486218853164,  -0.5029860367700724,    0.7504883828755602,
             0.3239847771997537,    0.3239847771997537,   -0.5794684678643381,    0.6740059517812944,
            -0.3239847771997537,   -0.6740059517812944,    0.5794684678643381,   -0.3239847771997537,
            -0.4004672082940195,   -0.7504883828755602,    0.5029860367700724,    0.15296486218853164,
        };

        const std::vector<std::vector<uint8_t>> LOOKUP_4D_VERTEX_CODES = {
            {0x15, 0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x15, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
            {0x01, 0x05, 0x11, 0x15, 0x41, 0x45, 0x51, 0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA},
            {0x01, 0x15, 0x16, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x15, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
            {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
            {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xAA},
            {0x05, 0x15, 0x16, 0x45, 0x46, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xAA, 0xAB},
            {0x04, 0x05, 0x14, 0x15, 0x44, 0x45, 0x54, 0x55, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA},
            {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xAA},
            {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x9A, 0xAA},
            {0x05, 0x15, 0x16, 0x45, 0x46, 0x55, 0x56, 0x59, 0x5A, 0x5B, 0x6A, 0x9A, 0xAA, 0xAB},
            {0x04, 0x15, 0x19, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x05, 0x15, 0x19, 0x45, 0x49, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xAA, 0xAE},
            {0x05, 0x15, 0x19, 0x45, 0x49, 0x55, 0x56, 0x59, 0x5A, 0x5E, 0x6A, 0x9A, 0xAA, 0xAE},
            {0x05, 0x15, 0x1A, 0x45, 0x4A, 0x55, 0x56, 0x59, 0x5A, 0x5B, 0x5E, 0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x15, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x11, 0x15, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
            {0x11, 0x15, 0x51, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x96, 0xA6, 0xAA},
            {0x11, 0x15, 0x16, 0x51, 0x52, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x96, 0xA6, 0xAA, 0xAB},
            {0x14, 0x15, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x9A, 0xA6, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x15, 0x16, 0x55, 0x56, 0x5A, 0x66, 0x6A, 0x6B, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x14, 0x15, 0x54, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x99, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x9A, 0xAA},
            {0x15, 0x16, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x6B, 0x9A, 0xAA, 0xAB},
            {0x14, 0x15, 0x19, 0x54, 0x55, 0x58, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x99, 0xA9, 0xAA, 0xAE},
            {0x15, 0x19, 0x55, 0x59, 0x5A, 0x69, 0x6A, 0x6E, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x15, 0x19, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x6E, 0x9A, 0xAA, 0xAE},
            {0x15, 0x1A, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x6B, 0x6E, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x10, 0x11, 0x14, 0x15, 0x50, 0x51, 0x54, 0x55, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x11, 0x15, 0x51, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xAA},
            {0x11, 0x15, 0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0xA6, 0xAA},
            {0x11, 0x15, 0x16, 0x51, 0x52, 0x55, 0x56, 0x65, 0x66, 0x67, 0x6A, 0xA6, 0xAA, 0xAB},
            {0x14, 0x15, 0x54, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA6, 0xAA},
            {0x15, 0x16, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x6B, 0xA6, 0xAA, 0xAB},
            {0x14, 0x15, 0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xAA},
            {0x15, 0x16, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x6B, 0xAA, 0xAB},
            {0x14, 0x15, 0x19, 0x54, 0x55, 0x58, 0x59, 0x65, 0x69, 0x6A, 0x6D, 0xA9, 0xAA, 0xAE},
            {0x15, 0x19, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x6E, 0xA9, 0xAA, 0xAE},
            {0x15, 0x19, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x6E, 0xAA, 0xAE},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x69, 0x6A, 0x6B, 0x6E, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x10, 0x15, 0x25, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x11, 0x15, 0x25, 0x51, 0x55, 0x56, 0x61, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xAA, 0xBA},
            {0x11, 0x15, 0x25, 0x51, 0x55, 0x56, 0x61, 0x65, 0x66, 0x6A, 0x76, 0xA6, 0xAA, 0xBA},
            {0x11, 0x15, 0x26, 0x51, 0x55, 0x56, 0x62, 0x65, 0x66, 0x67, 0x6A, 0x76, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x14, 0x15, 0x25, 0x54, 0x55, 0x59, 0x64, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA9, 0xAA, 0xBA},
            {0x15, 0x25, 0x55, 0x65, 0x66, 0x69, 0x6A, 0x7A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x25, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0x7A, 0xA6, 0xAA, 0xBA},
            {0x15, 0x26, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x6B, 0x7A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x14, 0x15, 0x25, 0x54, 0x55, 0x59, 0x64, 0x65, 0x69, 0x6A, 0x79, 0xA9, 0xAA, 0xBA},
            {0x15, 0x25, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x7A, 0xA9, 0xAA, 0xBA},
            {0x15, 0x25, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x7A, 0xAA, 0xBA},
            {0x15, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x6B, 0x7A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x14, 0x15, 0x29, 0x54, 0x55, 0x59, 0x65, 0x68, 0x69, 0x6A, 0x6D, 0x79, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x15, 0x29, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x6E, 0x7A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x15, 0x55, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x6E, 0x7A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x6B, 0x6E, 0x7A, 0xAA, 0xAB, 0xAE, 0xBA, 0xBF},
            {0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x5A, 0x66, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
            {0x41, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56, 0x5A, 0x66, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x44, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x45, 0x46, 0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x5A, 0x69, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
            {0x45, 0x46, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x96, 0x9A, 0x9B, 0xAA, 0xAB},
            {0x44, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59, 0x5A, 0x69, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x45, 0x49, 0x55, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE},
            {0x45, 0x49, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x99, 0x9A, 0x9E, 0xAA, 0xAE},
            {0x45, 0x4A, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x9A, 0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x95, 0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x59, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xAB},
            {0x51, 0x52, 0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xA7, 0xAA, 0xAB},
            {0x54, 0x55, 0x56, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x15, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAE},
            {0x15, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE},
            {0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x58, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAD, 0xAE},
            {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x55, 0x56, 0x59, 0x5A, 0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x66, 0x69, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
            {0x51, 0x52, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x96, 0xA6, 0xA7, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA},
            {0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
            {0x15, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x9A, 0xA6, 0xA9, 0xAA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x58, 0x59, 0x65, 0x69, 0x6A, 0x99, 0xA9, 0xAA, 0xAD, 0xAE},
            {0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x69, 0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65, 0x66, 0x69, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x51, 0x55, 0x61, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA},
            {0x51, 0x55, 0x56, 0x61, 0x65, 0x66, 0x6A, 0xA5, 0xA6, 0xAA, 0xB6, 0xBA},
            {0x51, 0x55, 0x56, 0x62, 0x65, 0x66, 0x6A, 0xA6, 0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xBB},
            {0x54, 0x55, 0x64, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA},
            {0x55, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x55, 0x56, 0x65, 0x66, 0x6A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x54, 0x55, 0x59, 0x64, 0x65, 0x69, 0x6A, 0xA5, 0xA9, 0xAA, 0xB9, 0xBA},
            {0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x15, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x54, 0x55, 0x59, 0x65, 0x68, 0x69, 0x6A, 0xA9, 0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xBE},
            {0x55, 0x59, 0x65, 0x69, 0x6A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x15, 0x55, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xAA, 0xAB, 0xAE, 0xBA, 0xBF},
            {0x40, 0x41, 0x44, 0x45, 0x50, 0x51, 0x54, 0x55, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
            {0x41, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56, 0x95, 0x96, 0x97, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA},
            {0x45, 0x46, 0x55, 0x56, 0x5A, 0x95, 0x96, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
            {0x45, 0x46, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0x9B, 0xAA, 0xAB},
            {0x44, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59, 0x95, 0x99, 0x9A, 0x9D, 0xA9, 0xAA, 0xAE},
            {0x45, 0x49, 0x55, 0x59, 0x5A, 0x95, 0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE},
            {0x45, 0x49, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0x9E, 0xAA, 0xAE},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x96, 0x99, 0x9A, 0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x95, 0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA},
            {0x51, 0x52, 0x55, 0x56, 0x66, 0x95, 0x96, 0x9A, 0xA6, 0xA7, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xEA},
            {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
            {0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xEA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x58, 0x59, 0x69, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAD, 0xAE},
            {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x96, 0x99, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
            {0x51, 0x52, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA7, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x51, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xAB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB},
            {0x54, 0x55, 0x58, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA, 0xAD, 0xAE},
            {0x54, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAE},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAE},
            {0x55, 0x56, 0x59, 0x5A, 0x66, 0x69, 0x6A, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xAF},
            {0x50, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xB5, 0xBA},
            {0x51, 0x55, 0x61, 0x65, 0x66, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA},
            {0x51, 0x55, 0x56, 0x61, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xAA, 0xB6, 0xBA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x96, 0xA5, 0xA6, 0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xBB},
            {0x54, 0x55, 0x64, 0x65, 0x69, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA},
            {0x55, 0x65, 0x66, 0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x96, 0xA5, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x54, 0x55, 0x59, 0x64, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA, 0xB9, 0xBA},
            {0x54, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
            {0x55, 0x56, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA, 0xBB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x99, 0xA5, 0xA9, 0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xBE},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x99, 0xA5, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x55, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xBA},
            {0x40, 0x45, 0x51, 0x54, 0x55, 0x85, 0x91, 0x94, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x85, 0x91, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA, 0xEA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x85, 0x91, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xD6, 0xEA},
            {0x41, 0x45, 0x51, 0x55, 0x56, 0x86, 0x92, 0x95, 0x96, 0x97, 0x9A, 0xA6, 0xAA, 0xAB, 0xD6, 0xEA, 0xEB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x85, 0x94, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xEA},
            {0x45, 0x55, 0x85, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xDA, 0xEA},
            {0x45, 0x55, 0x56, 0x85, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xDA, 0xEA},
            {0x45, 0x55, 0x56, 0x86, 0x95, 0x96, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB, 0xDA, 0xEA, 0xEB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x85, 0x94, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xD9, 0xEA},
            {0x45, 0x55, 0x59, 0x85, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xDA, 0xEA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x85, 0x95, 0x96, 0x99, 0x9A, 0xAA, 0xDA, 0xEA},
            {0x45, 0x55, 0x56, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB, 0xDA, 0xEA, 0xEB},
            {0x44, 0x45, 0x54, 0x55, 0x59, 0x89, 0x95, 0x98, 0x99, 0x9A, 0x9D, 0xA9, 0xAA, 0xAE, 0xD9, 0xEA, 0xEE},
            {0x45, 0x55, 0x59, 0x89, 0x95, 0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE, 0xDA, 0xEA, 0xEE},
            {0x45, 0x55, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE, 0xDA, 0xEA, 0xEE},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xDA, 0xEA, 0xEF},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x91, 0x94, 0x95, 0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x51, 0x55, 0x91, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xE6, 0xEA},
            {0x51, 0x55, 0x56, 0x91, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xE6, 0xEA},
            {0x51, 0x55, 0x56, 0x92, 0x95, 0x96, 0x9A, 0xA6, 0xA7, 0xAA, 0xAB, 0xE6, 0xEA, 0xEB},
            {0x54, 0x55, 0x94, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xE9, 0xEA},
            {0x55, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x55, 0x56, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x55, 0x56, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
            {0x54, 0x55, 0x59, 0x94, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xE9, 0xEA},
            {0x55, 0x59, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x45, 0x55, 0x56, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
            {0x54, 0x55, 0x59, 0x95, 0x98, 0x99, 0x9A, 0xA9, 0xAA, 0xAD, 0xAE, 0xE9, 0xEA, 0xEE},
            {0x55, 0x59, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
            {0x45, 0x55, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
            {0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xAA, 0xAB, 0xAE, 0xEA, 0xEF},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x91, 0x94, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xE5, 0xEA},
            {0x51, 0x55, 0x65, 0x91, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xE6, 0xEA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x91, 0x95, 0x96, 0xA5, 0xA6, 0xAA, 0xE6, 0xEA},
            {0x51, 0x55, 0x56, 0x66, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA7, 0xAA, 0xAB, 0xE6, 0xEA, 0xEB},
            {0x54, 0x55, 0x65, 0x94, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xE9, 0xEA},
            {0x55, 0x65, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x51, 0x55, 0x56, 0x66, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x94, 0x95, 0x99, 0xA5, 0xA9, 0xAA, 0xE9, 0xEA},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x55, 0x56, 0x59, 0x65, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
            {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xEA, 0xEB},
            {0x54, 0x55, 0x59, 0x69, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAD, 0xAE, 0xE9, 0xEA, 0xEE},
            {0x54, 0x55, 0x59, 0x69, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
            {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
            {0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xEA},
            {0x50, 0x51, 0x54, 0x55, 0x65, 0x95, 0xA1, 0xA4, 0xA5, 0xA6, 0xA9, 0xAA, 0xB5, 0xBA, 0xE5, 0xEA, 0xFA},
            {0x51, 0x55, 0x65, 0x95, 0xA1, 0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA, 0xE6, 0xEA, 0xFA},
            {0x51, 0x55, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA, 0xE6, 0xEA, 0xFA},
            {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xE6, 0xEA, 0xFB},
            {0x54, 0x55, 0x65, 0x95, 0xA4, 0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA, 0xE9, 0xEA, 0xFA},
            {0x55, 0x65, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
            {0x51, 0x55, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
            {0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xAA, 0xAB, 0xBA, 0xEA, 0xFB},
            {0x54, 0x55, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA, 0xE9, 0xEA, 0xFA},
            {0x54, 0x55, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
            {0x55, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
            {0x55, 0x56, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA, 0xEA},
            {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xE9, 0xEA, 0xFE},
            {0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA, 0xAE, 0xBA, 0xEA, 0xFE},
            {0x55, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA, 0xEA},
            {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xBA, 0xEA},
        };

        struct LatticeVertex4D {
            float dx, dy, dz, dw;
            int64_t xsvp, ysvp, zsvp, wsvp;
            
            static LatticeVertex4D create(int xsv, int ysv, int zsv, int wsv) {
                float ssv = (float)(xsv + ysv + zsv + wsv) * UNSKEW_4D;
                LatticeVertex4D v;
                v.xsvp = (int64_t)((uint64_t)xsv * (uint64_t)PRIME_X);
                v.ysvp = (int64_t)((uint64_t)ysv * (uint64_t)PRIME_Y);
                v.zsvp = (int64_t)((uint64_t)zsv * (uint64_t)PRIME_Z);
                v.wsvp = (int64_t)((uint64_t)wsv * (uint64_t)PRIME_W);
                v.dx = -(float)xsv - ssv;
                v.dy = -(float)ysv - ssv;
                v.dz = -(float)zsv - ssv;
                v.dw = -(float)wsv - ssv;
                return v;
            }
        };

        struct StaticData {
            std::vector<float> gradients2D;
            std::vector<float> gradients3D;
            std::vector<float> gradients4D;
            std::vector<int> lookup4DA; // Packed start/stop indices
            std::vector<LatticeVertex4D> lookup4DB;
        };
        
        static std::once_flag init_flag;
        static StaticData staticData;

        void initStaticData() {
            // Initialize gradients
            // 2D
             staticData.gradients2D.resize(N_GRADS_2D * 2);
            for (int i = 0; i < N_GRADS_2D * 2; ++i) {
                int srcIdx = i % (sizeof(GRAD2_SRC)/sizeof(double));
                 staticData.gradients2D[i] = (float)(GRAD2_SRC[srcIdx] / NORMALIZER_2D);
            }
            // 3D
             staticData.gradients3D.resize(N_GRADS_3D * 4);
            for (int i = 0; i < N_GRADS_3D * 4; ++i) {
                int srcIdx = i % (sizeof(GRAD3_SRC)/sizeof(double));
                 staticData.gradients3D[i] = (float)(GRAD3_SRC[srcIdx] / NORMALIZER_3D);
            }
            // 4D
             staticData.gradients4D.resize(N_GRADS_4D * 4);
            for (int i = 0; i < N_GRADS_4D * 4; ++i) {
                int srcIdx = i % (sizeof(GRAD4_SRC)/sizeof(double));
                 staticData.gradients4D[i] = (float)(GRAD4_SRC[srcIdx] / NORMALIZER_4D);
            }

            // Initialize lookup4D
            int nLatticeVerticesTotal = 0;
            for (const auto& v : LOOKUP_4D_VERTEX_CODES) nLatticeVerticesTotal += (int)v.size();
            
            staticData.lookup4DA.resize(256);
            staticData.lookup4DB.resize(nLatticeVerticesTotal);
            
            // Precompute basic vertices
            std::vector<LatticeVertex4D> latticeVerticesByCode(256);
            for (int i = 0; i < 256; i++) {
                int cx = ((i >> 0) & 3) - 1;
                int cy = ((i >> 2) & 3) - 1;
                int cz = ((i >> 4) & 3) - 1;
                int cw = ((i >> 6) & 3) - 1;
                latticeVerticesByCode[i] = LatticeVertex4D::create(cx, cy, cz, cw);
            }
            
            int j = 0;
            for (int i = 0; i < 256; i++) {
                int count = (int)LOOKUP_4D_VERTEX_CODES[i].size();
                staticData.lookup4DA[i] = j | ((j + count) << 16);
                for (int k = 0; k < count; k++) {
                    staticData.lookup4DB[j] = latticeVerticesByCode[LOOKUP_4D_VERTEX_CODES[i][k]];
                    j++;
                }
            }
        }

        const StaticData& getStaticData() {
            std::call_once(init_flag, initStaticData);
            return staticData;
        }

        inline int fastFloor(double x) {
            int xi = (int)x;
            return x < xi ? xi - 1 : xi;
        }

        inline int fastRound(double x) {
            return (x < 0) ? (int)(x - 0.5) : (int)(x + 0.5);
        }
    }
}


namespace {
    using namespace Smooth;

    inline float smooth_grad2(int64_t seed, int64_t xsvp, int64_t ysvp, float dx, float dy) {
        int64_t hash = seed ^ xsvp ^ ysvp;
        hash = (int64_t)((uint64_t)hash * (uint64_t)HASH_MULTIPLIER);
        hash ^= hash >> (64 - N_GRADS_2D_EXPONENT + 1);
        int gi = (int)(hash & ((N_GRADS_2D - 1) << 1));
        const auto& grads = getStaticData().gradients2D;
        return grads[gi] * dx + grads[gi + 1] * dy;
    }

    inline float smooth_grad3(int64_t seed, int64_t xrvp, int64_t yrvp, int64_t zrvp, float dx, float dy, float dz) {
        int64_t hash = (seed ^ xrvp) ^ (yrvp ^ zrvp);
         hash = (int64_t)((uint64_t)hash * (uint64_t)HASH_MULTIPLIER);
        hash ^= hash >> (64 - N_GRADS_3D_EXPONENT + 2);
        int gi = (int)(hash & ((N_GRADS_3D - 1) << 2));
        const auto& grads = getStaticData().gradients3D;
        return grads[gi] * dx + grads[gi + 1] * dy + grads[gi + 2] * dz;
    }
    
    inline float smooth_grad4(int64_t seed, int64_t xsvp, int64_t ysvp, int64_t zsvp, int64_t wsvp, float dx, float dy, float dz, float dw) {
        int64_t hash = seed ^ (xsvp ^ ysvp) ^ (zsvp ^ wsvp);
         hash = (int64_t)((uint64_t)hash * (uint64_t)HASH_MULTIPLIER);
        hash ^= hash >> (64 - N_GRADS_4D_EXPONENT + 2);
        int gi = (int)(hash & ((N_GRADS_4D - 1) << 2));
        const auto& grads = getStaticData().gradients4D;
        return grads[gi] * dx + grads[gi + 1] * dy + grads[gi + 2] * dz + grads[gi + 3] * dw;
    }
}

float OpenSimplex2S::noise2_UnskewedBase(int64_t seed, double xs, double ys) {
    int xsb = fastFloor(xs);
    int ysb = fastFloor(ys);
    float xi = (float)(xs - xsb);
    float yi = (float)(ys - ysb);

    int64_t xsbp = (int64_t)((uint64_t)xsb * (uint64_t)PRIME_X);
    int64_t ysbp = (int64_t)((uint64_t)ysb * (uint64_t)PRIME_Y);

    float t = (xi + yi) * (float)UNSKEW_2D;
    float dx0 = xi + t;
    float dy0 = yi + t;

    float value = 0.0f;
    float a0 = RSQUARED_2D - dx0 * dx0 - dy0 * dy0;
    if (a0 > 0.0f) {
        value = (a0 * a0) * (a0 * a0) * smooth_grad2(seed, xsbp, ysbp, dx0, dy0);
    }
    
    float a1 = (float)(2.0 * (1.0 + 2.0 * UNSKEW_2D) * (1.0 / UNSKEW_2D + 2.0)) * t
               + (float)((-2.0 * (1.0 + 2.0 * UNSKEW_2D) * (1.0 + 2.0 * UNSKEW_2D)) + a0);
               
    if (a1 > 0.0f) {
        float dx1 = dx0 - (float)(1.0 + 2.0 * UNSKEW_2D);
        float dy1 = dy0 - (float)(1.0 + 2.0 * UNSKEW_2D);
        value += (a1 * a1) * (a1 * a1) * smooth_grad2(seed, (int64_t)((uint64_t)xsbp + (uint64_t)PRIME_X), (int64_t)((uint64_t)ysbp + (uint64_t)PRIME_Y), dx1, dy1);
    }
    
    if (dy0 > dx0) {
        float dx2 = dx0 - (float)UNSKEW_2D;
        float dy2 = dy0 - (float)(UNSKEW_2D + 1.0);
        float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
        if (a2 > 0.0f) {
            value += (a2 * a2) * (a2 * a2) * smooth_grad2(seed, xsbp, (int64_t)((uint64_t)ysbp + (uint64_t)PRIME_Y), dx2, dy2);
        }
    } else {
        float dx2 = dx0 - (float)(UNSKEW_2D + 1.0);
        float dy2 = dy0 - (float)UNSKEW_2D;
        float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
        if (a2 > 0.0f) {
            value += (a2 * a2) * (a2 * a2) * smooth_grad2(seed, (int64_t)((uint64_t)xsbp + (uint64_t)PRIME_X), ysbp, dx2, dy2);
        }
    }
    return value;
}

float OpenSimplex2S::noise2(int64_t seed, double x, double y) {
    double s = SKEW_2D * (x + y);
    return noise2_UnskewedBase(seed, x + s, y + s);
}

float OpenSimplex2S::noise3_UnrotatedBase(int64_t seed, double xr, double yr, double zr) {
    int xrb = fastFloor(xr);
    int yrb = fastFloor(yr);
    int zrb = fastFloor(zr);
    float xri = (float)(xr - xrb);
    float yri = (float)(yr - yrb);
    float zri = (float)(zr - zrb);

    int64_t xrbp = (int64_t)((uint64_t)xrb * (uint64_t)PRIME_X);
    int64_t yrbp = (int64_t)((uint64_t)yrb * (uint64_t)PRIME_Y);
    int64_t zrbp = (int64_t)((uint64_t)zrb * (uint64_t)PRIME_Z);
    int64_t seed2 = seed ^ SEED_FLIP_3D;

    int xNMask = (int)(-0.5f - xri);
    int yNMask = (int)(-0.5f - yri);
    int zNMask = (int)(-0.5f - zri);

    float x0 = xri + (float)xNMask;
    float y0 = yri + (float)yNMask;
    float z0 = zri + (float)zNMask;
    
    float a0 = RSQUARED_3D - x0 * x0 - y0 * y0 - z0 * z0;
    float value = 0.0f;
    if (a0 > 0.0f) {
        value += (a0 * a0) * (a0 * a0) * smooth_grad3(
            seed,
            xrbp + ((int64_t)xNMask & PRIME_X),
            yrbp + ((int64_t)yNMask & PRIME_Y),
            zrbp + ((int64_t)zNMask & PRIME_Z),
            x0, y0, z0
        );
    }

    float x1 = xri - 0.5f;
    float y1 = yri - 0.5f;
    float z1 = zri - 0.5f;
    float a1 = RSQUARED_3D - x1 * x1 - y1 * y1 - z1 * z1;
    if (a1 > 0.0f) {
        value += (a1 * a1) * (a1 * a1) * smooth_grad3(
            seed2,
            xrbp + PRIME_X,
            yrbp + PRIME_Y,
            zrbp + PRIME_Z,
            x1, y1, z1
        );
    }

    float xAFlipMask0 = ((float)((xNMask | 1) << 1)) * x1;
    float yAFlipMask0 = ((float)((yNMask | 1) << 1)) * y1;
    float zAFlipMask0 = ((float)((zNMask | 1) << 1)) * z1;
    float xAFlipMask1 = ((float)(-2 - (xNMask << 2))) * x1 - 1.0f;
    float yAFlipMask1 = ((float)(-2 - (yNMask << 2))) * y1 - 1.0f;
    float zAFlipMask1 = ((float)(-2 - (zNMask << 2))) * z1 - 1.0f;

    bool skip5 = false;
    float a2 = xAFlipMask0 + a0;
    if (a2 > 0.0f) {
        float x2 = x0 - (float)(xNMask | 1);
        float y2 = y0;
        float z2 = z0;
        value += (a2 * a2) * (a2 * a2) * smooth_grad3(
            seed,
            xrbp + ((int64_t)(~xNMask) & PRIME_X),
            yrbp + ((int64_t)yNMask & PRIME_Y),
            zrbp + ((int64_t)zNMask & PRIME_Z),
            x2, y2, z2
        );
    } else {
        float a3 = yAFlipMask0 + zAFlipMask0 + a0;
        if (a3 > 0.0f) {
            float x3 = x0;
            float y3 = y0 - (float)(yNMask | 1);
            float z3 = z0 - (float)(zNMask | 1);
            value += (a3 * a3) * (a3 * a3) * smooth_grad3(
                seed,
                xrbp + ((int64_t)xNMask & PRIME_X),
                yrbp + ((int64_t)(~yNMask) & PRIME_Y),
                zrbp + ((int64_t)(~zNMask) & PRIME_Z),
                x3, y3, z3
            );
        }

        float a4 = xAFlipMask1 + a1;
        if (a4 > 0.0f) {
            float x4 = (float)(xNMask | 1) + x1;
            float y4 = y1;
            float z4 = z1;
            value += (a4 * a4) * (a4 * a4) * smooth_grad3(
                seed2,
                xrbp + ((int64_t)xNMask & (PRIME_X << 1)),
                yrbp + PRIME_Y,
                zrbp + PRIME_Z,
                x4, y4, z4
            );
            skip5 = true;
        }
    }

    bool skip9 = false;
    float a6 = yAFlipMask0 + a0;
    if (a6 > 0.0f) {
        float x6 = x0;
        float y6 = y0 - (float)(yNMask | 1);
        float z6 = z0;
        value += (a6 * a6) * (a6 * a6) * smooth_grad3(
            seed,
            xrbp + ((int64_t)xNMask & PRIME_X),
            yrbp + ((int64_t)(~yNMask) & PRIME_Y),
            zrbp + ((int64_t)zNMask & PRIME_Z),
            x6, y6, z6
        );
    } else {
        float a7 = xAFlipMask0 + zAFlipMask0 + a0;
        if (a7 > 0.0f) {
            float x7 = x0 - (float)(xNMask | 1);
            float y7 = y0;
            float z7 = z0 - (float)(zNMask | 1);
            value += (a7 * a7) * (a7 * a7) * smooth_grad3(
                seed,
                xrbp + ((int64_t)(~xNMask) & PRIME_X),
                yrbp + ((int64_t)yNMask & PRIME_Y),
                zrbp + ((int64_t)(~zNMask) & PRIME_Z),
                x7, y7, z7
            );
        }

        float a8 = yAFlipMask1 + a1;
        if (a8 > 0.0f) {
            float x8 = x1;
            float y8 = (float)(yNMask | 1) + y1;
            float z8 = z1;
            value += (a8 * a8) * (a8 * a8) * smooth_grad3(
                seed2,
                xrbp + PRIME_X,
                yrbp + ((int64_t)yNMask & (PRIME_Y << 1)),
                zrbp + PRIME_Z,
                x8, y8, z8
            );
            skip9 = true;
        }
    }

    bool skipD = false;
    float aA_val = zAFlipMask0 + a0;
    if (aA_val > 0.0f) {
        float xA = x0;
        float yA = y0;
        float zA = z0 - (float)(zNMask | 1);
        value += (aA_val * aA_val) * (aA_val * aA_val) * smooth_grad3(
            seed,
            xrbp + ((int64_t)xNMask & PRIME_X),
            yrbp + ((int64_t)yNMask & PRIME_Y),
            zrbp + ((int64_t)(~zNMask) & PRIME_Z),
            xA, yA, zA
        );
    } else {
        float aB = xAFlipMask0 + yAFlipMask0 + a0;
        if (aB > 0.0f) {
            float xB = x0 - (float)(xNMask | 1);
            float yB = y0 - (float)(yNMask | 1);
            float zB = z0;
            value += (aB * aB) * (aB * aB) * smooth_grad3(
                seed,
                xrbp + ((int64_t)(~xNMask) & PRIME_X),
                yrbp + ((int64_t)(~yNMask) & PRIME_Y),
                zrbp + ((int64_t)zNMask & PRIME_Z),
                xB, yB, zB
            );
        }

        float aC = zAFlipMask1 + a1;
        if (aC > 0.0f) {
            float xC = x1;
            float yC = y1;
            float zC = (float)(zNMask | 1) + z1;
            value += (aC * aC) * (aC * aC) * smooth_grad3(
                seed2,
                xrbp + PRIME_X,
                yrbp + PRIME_Y,
                zrbp + ((int64_t)zNMask & (PRIME_Z << 1)),
                xC, yC, zC
            );
            skipD = true;
        }
    }

    if (!skip5) {
        float a5 = yAFlipMask1 + zAFlipMask1 + a1;
        if (a5 > 0.0f) {
            float x5 = x1;
            float y5 = (float)(yNMask | 1) + y1;
            float z5 = (float)(zNMask | 1) + z1;
            value += (a5 * a5) * (a5 * a5) * smooth_grad3(
                seed2,
                xrbp + PRIME_X,
                yrbp + ((int64_t)yNMask & (PRIME_Y << 1)),
                zrbp + ((int64_t)zNMask & (PRIME_Z << 1)),
                x5, y5, z5
            );
        }
    }

    if (!skip9) {
        float a9 = xAFlipMask1 + zAFlipMask1 + a1;
        if (a9 > 0.0f) {
            float x9 = (float)(xNMask | 1) + x1;
            float y9 = y1;
            float z9 = (float)(zNMask | 1) + z1;
            value += (a9 * a9) * (a9 * a9) * smooth_grad3(
                seed2,
                xrbp + ((int64_t)xNMask & (PRIME_X << 1)),
                yrbp + PRIME_Y,
                zrbp + ((int64_t)zNMask & (PRIME_Z << 1)),
                x9, y9, z9
            );
        }
    }

    if (!skipD) {
        float aD = xAFlipMask1 + yAFlipMask1 + a1;
        if (aD > 0.0f) {
            float xD = (float)(xNMask | 1) + x1;
            float yD = (float)(yNMask | 1) + y1;
            float zD = z1;
            value += (aD * aD) * (aD * aD) * smooth_grad3(
                seed2,
                xrbp + ((int64_t)xNMask & (PRIME_X << 1)),
                yrbp + ((int64_t)yNMask & (PRIME_Y << 1)),
                zrbp + PRIME_Z,
                xD, yD, zD
            );
        }
    }

    return value;
}

float OpenSimplex2S::noise3_ImproveXY(int64_t seed, double x, double y, double z) {
    double xy = x + y;
    double s2 = xy * ROTATE3_ORTHOGONALIZER;
    double zz = z * ROOT3OVER3;
    double xr = x + s2 + zz;
    double yr = y + s2 + zz;
    double zr = xy * -ROOT3OVER3 + zz;
    return noise3_UnrotatedBase(seed, xr, yr, zr);
}

float OpenSimplex2S::noise3_ImproveXZ(int64_t seed, double x, double y, double z) {
    double xz = x + z;
    double s2 = xz * -0.211324865405187;
    double yy = y * ROOT3OVER3;
    double xr = x + s2 + yy;
    double zr = z + s2 + yy;
    double yr = xz * -ROOT3OVER3 + yy;
    return noise3_UnrotatedBase(seed, xr, yr, zr);
}

float OpenSimplex2S::noise3_Fallback(int64_t seed, double x, double y, double z) {
    double r = FALLBACK_ROTATE3 * (x + y + z);
    return noise3_UnrotatedBase(seed, r - x, r - y, r - z);
}







float OpenSimplex2S::noise4_UnskewedBase(int64_t seed, double xs, double ys, double zs, double ws) {
    int xsb = fastFloor(xs);
    int ysb = fastFloor(ys);
    int zsb = fastFloor(zs);
    int wsb = fastFloor(ws);
    
    float xsi = (float)(xs - xsb);
    float ysi = (float)(ys - ysb);
    float zsi = (float)(zs - zsb);
    float wsi = (float)(ws - wsb);
    
    float ssi = (xsi + ysi + zsi + wsi) * UNSKEW_4D;
    float xi = xsi + ssi;
    float yi = ysi + ssi;
    float zi = zsi + ssi;
    float wi = wsi + ssi;
    
    int64_t xsvp = (int64_t)((uint64_t)xsb * (uint64_t)PRIME_X);
    int64_t ysvp = (int64_t)((uint64_t)ysb * (uint64_t)PRIME_Y);
    int64_t zsvp = (int64_t)((uint64_t)zsb * (uint64_t)PRIME_Z);
    int64_t wsvp = (int64_t)((uint64_t)wsb * (uint64_t)PRIME_W);
    
    int index = ((fastFloor(xs * 4.0) & 3) << 0)
              | ((fastFloor(ys * 4.0) & 3) << 2)
              | ((fastFloor(zs * 4.0) & 3) << 4)
              | ((fastFloor(ws * 4.0) & 3) << 6);
              
    const auto& staticData = getStaticData();
    float value = 0.0f;
    int secondaryIndexStartAndStop = staticData.lookup4DA[index];
    int secondaryIndexStart = secondaryIndexStartAndStop & 0xFFFF;
    int secondaryIndexStop = secondaryIndexStartAndStop >> 16;
    
    for (int i = secondaryIndexStart; i < secondaryIndexStop; ++i) {
        const auto& c = staticData.lookup4DB[i];
        float dx = xi + c.dx;
        float dy = yi + c.dy;
        float dz = zi + c.dz;
        float dw = wi + c.dw;
        
        float a = RSQUARED_4D - (dx * dx + dy * dy + dz * dz + dw * dw);
        if (a > 0.0f) {
            value += (a * a) * (a * a) * smooth_grad4(
                seed,
                xsvp + c.xsvp,
                ysvp + c.ysvp,
                zsvp + c.zsvp,
                wsvp + c.wsvp,
                dx, dy, dz, dw
            );
        }
    }
    
    return value;
}

float OpenSimplex2S::noise4_ImproveXYZ_ImproveXY(int64_t seed, double x, double y, double z, double w) {
    double xy = x + y;
    double s2 = xy * -0.21132486540518699998;
    double zz = z * 0.28867513459481294226;
    double ww = w * 1.118033988749894;
    double xr = x + (zz + ww + s2);
    double yr = y + (zz + ww + s2);
    double zr = xy * -0.57735026918962599998 + (zz + ww);
    double wr = z * -0.866025403784439 + ww;
    return noise4_UnskewedBase(seed, xr, yr, zr, wr);
}

float OpenSimplex2S::noise4_ImproveXYZ_ImproveXZ(int64_t seed, double x, double y, double z, double w) {
    double xz = x + z;
    double s2 = xz * -0.21132486540518699998;
    double yy = y * 0.28867513459481294226;
    double ww = w * 1.118033988749894;
    double xr = x + (yy + ww + s2);
    double zr = z + (yy + ww + s2);
    double yr = xz * -0.57735026918962599998 + (yy + ww);
    double wr = y * -0.866025403784439 + ww;
    return noise4_UnskewedBase(seed, xr, yr, zr, wr);
}

float OpenSimplex2S::noise4_ImproveXYZ(int64_t seed, double x, double y, double z, double w) {
    double xyz = x + y + z;
    double ww = w * 1.118033988749894;
    double s2 = xyz * -0.16666666666666666 + ww;
    double xs = x + s2;
    double ys = y + s2;
    double zs = z + s2;
    double ws = -0.5 * xyz + ww;
    return noise4_UnskewedBase(seed, xs, ys, zs, ws);
}

float OpenSimplex2S::noise4_ImproveXY_ImproveZW(int64_t seed, double x, double y, double z, double w) {
    double s2 = (x + y) * -0.28522513987434876941 + (z + w) * 0.83897065470611435718;
    double t2 = (z + w) * 0.21939749883706435719 + (x + y) * -0.48214856493302476942;
    double xs = x + s2;
    double ys = y + s2;
    double zs = z + t2;
    double ws = w + t2;
    return noise4_UnskewedBase(seed, xs, ys, zs, ws);
}

float OpenSimplex2S::noise4_Fallback(int64_t seed, double x, double y, double z, double w) {
    double s = SKEW_4D * (x + y + z + w);
    return noise4_UnskewedBase(seed, x + s, y + s, z + s, w + s);
}
